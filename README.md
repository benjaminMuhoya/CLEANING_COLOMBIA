# CLEANING_COLOMBIA
Data Wrangler Expert level unlocked. 
`Extract_all_columns.py` takes every lab Excel in the `./xls` folder and cleans just the text-y bits at the front of each sheet so later scripts can match things reliably. It trims stray spaces, turns punctuation and spaces into underscores, and skips stuff like “Test Name” or any columns we don't need. It saves a headerless, per-file CSV into `./normalized_files/` and writes a simple “old name → new name” ledger so you can see exactly how labels were normalized.

`COLOMBIA_AFRICA.py` then combines those normalized CSVs into a single, analysis-ready table. For each file, it retrieves the patient/sample metadata from fixed positions, looks up the normalized test names in the first few columns, and extracts the corresponding result cells located a few columns to the right. It also tidies known duplicates (especially urine measures) and collapses several calcium variants into a single corrected calcium field. The result is a single wide CSV file, one row per file, plus an error log that notes any missing or unusual cells.

`Impute_PH_URINE.py` finally patches your cohort metadata by filling in two specific columns that were in weird locations on the sheets —urine pH and GGT—using the normalized per-file CSVs as the source of truth. For each META row, it finds the matching file, fuzzy-matches the urine pH label to retrieve a nearby non-empty value, and exact-matches the GGT label to obtain its result from the expected result column. It adds these values into the META table and writes out an updated metadata CSV for downstream analysis.
